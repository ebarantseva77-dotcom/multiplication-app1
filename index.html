<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Таблица умножения</title>
  <style>
    body {font-family: Arial, sans-serif; text-align:center; background:#f7fafc; margin:0; padding:20px;}
    h1 {margin:10px 0 0; font-size:22px;}
    .photo {width: 220px; border-radius: 14px; margin: 10px auto; display:block; box-shadow:0 4px 12px rgba(0,0,0,.08);}
    .question {font-size: 32px; margin: 14px 0;}
    #timer {font-weight: bold; margin: 6px 0;}
    input {font-size: 22px; padding: 8px 10px; text-align:center; width: 160px; border-radius:10px; border:1px solid #cbd5e1;}
    button {font-size: 18px; margin-top: 10px; padding: 10px 18px; border-radius: 10px; border: none; background: #2563eb; color: #fff; cursor: pointer; box-shadow:0 2px 8px rgba(37,99,235,.3);}
    button:disabled {background:#94a3b8; cursor:not-allowed; box-shadow:none;}
    .stars {font-size: 26px; color: gold; margin: 10px; min-height: 32px;}
    .hidden {display:none;}
    .wrap {max-width:560px; margin:0 auto; background:#fff; border-radius:16px; padding:18px; box-shadow:0 6px 24px rgba(0,0,0,.08);}
    .row {display:flex; gap:10px; justify-content:center; align-items:center; margin-top:8px;}
    .muted {color:#6b7280; font-size:14px;}
    .tag {background:#e5e7eb; border-radius:8px; padding:4px 8px; display:inline-block; margin-bottom:8px;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="tag">Android WebView • 10 заданий • 90 секунд • 6 звуков</div>
    <h1>Игра: Таблица умножения</h1>
    <img id="teacherPhoto" class="photo" src="teacher.png" alt="Учительница" onerror="this.style.display='none'">
    <div id="timer">Время: 1:30</div>
    <div id="question" class="question">Нажмите «Начать»</div>
    <div class="row">
      <input type="number" id="answer" placeholder="Ваш ответ" disabled>
    </div>
    <div class="row">
      <button id="submit" disabled>Ответить</button>
      <button id="start">Начать</button>
      <button id="restart" class="hidden">Ещё раз</button>
    </div>
    <div id="feedback" class="row"></div>
    <div id="stars" class="stars"></div>
    <div id="results" class="hidden"></div>
    <div class="muted">Если нет звука: нажмите «Начать», затем дайте правильный ответ.</div>
  </div>

  <script>
    const praiseFiles = [
      "super.mp3",   // «супер»
      "molodec.mp3", // «молодец»
      "praise3.mp3",
      "praise4.mp3",
      "praise5.mp3",
      "praise6.mp3"
    ];

    const startBtn = document.getElementById("start");
    const restartBtn = document.getElementById("restart");
    const submitBtn = document.getElementById("submit");
    const questionEl = document.getElementById("question");
    const answerEl = document.getElementById("answer");
    const feedbackEl = document.getElementById("feedback");
    const starsEl = document.getElementById("stars");
    const resultsEl = document.getElementById("results");
    const timerEl = document.getElementById("timer");

    let a, b;
    let correct = 0;
    let wrong = 0;
    let total = 0;
    let timer;
    let timeLeft = 90; // 90 секунд

    function playRandomPraise() { 
      const file = praiseFiles[Math.floor(Math.random() * praiseFiles.length)];
      const audio = new Audio(file);
      audio.play().catch(()=>{});
    }

    function newQuestion() {
      a = Math.floor(Math.random() * 10) + 1;
      b = Math.floor(Math.random() * 10) + 1;
      questionEl.textContent = `${a} × ${b} = ?`;
      answerEl.value = "";
      answerEl.focus();
    }

    function updateTimer() {
      let minutes = Math.floor(timeLeft / 60);
      let seconds = timeLeft % 60;
      timerEl.textContent = `Время: ${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
      if (timeLeft <= 0) { endGame(); return; }
      timeLeft--;
    }

    function startGame() {
      correct = 0; wrong = 0; total = 0; timeLeft = 90;
      starsEl.textContent = "";
      resultsEl.classList.add("hidden");
      feedbackEl.textContent = '';
      answerEl.disabled = false;
      submitBtn.disabled = false;

      newQuestion();
      clearInterval(timer);
      timer = setInterval(updateTimer, 1000);
    }

    function submitAnswer() {
      const val = answerEl.value.trim();
      if (val === '') return;
      const ans = Number(val);
      if (!Number.isFinite(ans)) return;

      if (ans === a * b) {
        correct++;
        feedbackEl.textContent = "Правильно!";
        starsEl.textContent += "⭐";
        playRandomPraise();
      } else {
        wrong++;
        feedbackEl.textContent = `Неверно. Правильный ответ: ${a*b}`;
      }

      total++;
      if (total >= 10) endGame(); else newQuestion();
    }

    function endGame() {
      clearInterval(timer);
      answerEl.disabled = true;
      submitBtn.disabled = true;
      document.getElementById("start").classList.remove("hidden");
      document.getElementById("restart").classList.remove("hidden");
      document.getElementById("question").textContent = "Игра окончена!";
      resultsEl.classList.remove("hidden");
      resultsEl.innerHTML = `<h2>Результаты:</h2>
        ✅ Правильных: ${correct}<br>
        ❌ Ошибок: ${wrong}<br>
        ⭐ Звёздочек: ${"⭐".repeat(correct)}<br>`;
      if (correct > 0) playRandomPraise();
    }

    document.getElementById("start").addEventListener("click", startGame);
    document.getElementById("restart").addEventListener("click", startGame);
    document.getElementById("submit").addEventListener("click", submitAnswer);
    document.getElementById("answer").addEventListener("keypress", e => { if (e.key === "Enter") submitAnswer(); });
  </script>
</body>
</html>
